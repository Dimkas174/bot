const { Command } = require('discord.js-commando'),
      { RichEmbed } = require('discord.js'),
      request = require('request'),
      cheerio = require('cheerio'),
      vmpimg = 'https://i.imgur.com/r9ItZ6p.gif';

module.exports = class RpnCommand extends Command {
    constructor(client) {
        super(client, {
            name: 'rpn',
            aliases: ['—Ä–ø–Ω'],
            group: 'random',
            memberName: 'rpn',
            description: '–†–∞–Ω–¥–æ–º–Ω—ã–π, –º—É–∂—Å–∫–æ–π RP –Ω–∏–∫.',
            examples: ['rpn'],
            guildOnly: true,
            clientPermissions: [
                'ADD_REACTIONS',
                'MANAGE_MESSAGES',
                'SEND_MESSAGES',
                'EMBED_LINKS',
                'READ_MESSAGE_HISTORY'
            ],
            userPermissions: [
                'ADD_REACTIONS',
                'SEND_MESSAGES',
                'READ_MESSAGE_HISTORY'
            ],
            throttling: {
                usages: 2,
                duration: 5
            },
        });
    }

    async run(msg) {
        msg.react('üëå');
      
      let embed = new RichEmbed()
                  embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, this.client.user.displayAvatarURL)
                  embed.setColor('RANDOM')
                  embed.setDescription(`–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–ª–∞–≥ –Ω–∞–∂–∞–≤ –Ω–∞ emoji –ø–æ–¥ –¥–∞–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –≤ —Ç–µ—á–µ–Ω–∏–µ –º–∏–Ω—É—Ç—ã!`)
                  var mes2 = await msg.reply({embed});
                  await mes2.react('üá∫üá∏')
                  await mes2.react('üá™üá∏')
                  await mes2.react('üáØüáµ')
                  await mes2.react('üáÆüáπ')
                  await mes2.react('üá∑üá∫')
                  await mes2.react('üá´üá∑')
                  await mes2.react('üá∏üá™')
                  await mes2.react('üá©üá™')
                  await mes2.react('üá©üá∞')
                  await mes2.react('üá∑üá¥')
                  await mes2.react('üè≥Ô∏è‚Äçüåà')
                      
                  const collector = mes2.createReactionCollector((reaction, user) => reaction.emoji.name === 'üá∑üá∫' || reaction.emoji.name === 'üá∫üá∏' || reaction.emoji.name === 'üáØüáµ' || reaction.emoji.name === 'üáÆüáπ' || reaction.emoji.name === 'üá´üá∑' || reaction.emoji.name === 'üá∏üá™' || reaction.emoji.name === 'üá©üá™' || reaction.emoji.name === 'üá©üá∞'  || reaction.emoji.name === 'üá∑üá¥' || reaction.emoji.name === 'üá™üá∏' && user.id == msg.author.id, {time: 60000})
                  collector.on('collect', async r => {
                    switch(r.emoji.name) {
                      case 'üá∑üá∫':
                        
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=russian&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/MnaGs9V.png")
                          return msg.say(embed);
                        } else {
                           return msg.say(error.stack);
                        }
                      });
                      break
                      
                      case 'üá∫üá∏':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=american&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/C2otJbb.png")
                          return msg.say(embed);
                        } else {
                           return msg.say(error.stack);
                        }
                      });
                      break
                      
                      case 'üáØüáµ':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=japanese&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/gakNcoU.png")
                          return msg.say(embed);
                          } else {
                           return msg.say(error.stack);
                        }
                      });  
                      break
                      
                      case 'üáÆüáπ':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=italian&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/fsy0wHv.png")
                          return msg.say(embed);
                          } else {
                           return msg.say(error.stack);
                        }
                      });  
                      break
                      
                      case 'üá´üá∑':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=french&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/h4CXbY0.png")
                          return msg.say(embed);
                          } else {
                           return msg.say(error.stack);
                        }
                      });  
                      break
                      
                      case 'üá∏üá™':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=swedish&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/TCx3KpU.png")
                          return msg.say(embed);
                          } else {
                           return msg.say(error.stack);
                        }
                      });
                      break
                      
                      case 'üá©üá™':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=german&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/1tXh3iE.png")
                          return msg.say(embed);
                          } else {
                           return msg.say(error.stack);
                        }
                      });  
                      break
                      
                      case 'üá©üá∞':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=danish&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/U9ODM3u.png")
                          return msg.say(embed);
                          } else {
                           return msg.say(error.stack);
                        }
                      });
                      break
                  
                      case 'üá∑üá¥':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=romanian&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/m0DMsPb.png")
                          return msg.say(embed);
                          } else {
                           return msg.say(error.stack);
                        }
                      });
                      break
                      
                      case 'üá™üá∏':
                      var url = `http://www.rp-nicks.aa-roleplay.ru/index.php?gender=male&nation=latinos&name=&surname=`;
                        
                      request(url, function (error, response, body) {
                        if (!error) {
                          var $ = cheerio.load(body)
                          let full = $('body').text();
                          let name = /–∏–º—è: [a-zA-Z_]{2,}/gi;
                          let text = full.match(/–∏–º—è: [a-zA-Z_]{2,}/gi)[0];
                          let nick = text.replace(/–∏–º—è: /gi, "");
                          
                          let embed = new RichEmbed()
                          embed.setAuthor(`–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–ü –Ω–∏–∫–æ–≤`, vmpimg)
                          embed.setColor('RANDOM')
                          embed.setDescription(`–í–∞–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –ø–æ–¥–æ–π–¥—ë—Ç —ç—Ç–æ –∏–º—è:\n\`\`\`css
${nick}
\`\`\``)
                          embed.setThumbnail("https://i.imgur.com/nt0WnrC.png")
                          return msg.say(embed);
                          } else {
                           return msg.say(error.stack);
                        }
                      });
                      break
                    }
                  })
        
                  collector.on('end', async () => {
                  })
    }
};